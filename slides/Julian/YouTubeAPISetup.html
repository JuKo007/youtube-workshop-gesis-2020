<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Getting Access to the YouTube API</title>
    <meta charset="utf-8" />
    <meta name="author" content="Julian Kohne Johannes Breuer M. Rohangis Mohseni" />
    <meta name="date" content="2020-02-10" />
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
    <link rel="stylesheet" href="../workshop.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Getting Access to the YouTube API
## Preliminary Workshop Preperation
### Julian Kohne<br />Johannes Breuer<br />M. Rohangis Mohseni
### 2020-02-10

---

# Setting up API Access

- To effectively work with YouTube data, we need access to it's Application Programming Interface (API)

- As this process can be quite tedious, we prepared this preliminary tutorial so nobody
  has to spend time troubleshooting their API access during the workshop
  
- Please follow this tutorial and check if the setup works before the workshop

- If your setup does not work, feel free to contact us in a timely manner for assistance with trouble shooting

- In case API access is suspended or fails for some participants, we will have prepared datasets on site that
  you can still work with
  
- [HINT](https://en.wikipedia.org/wiki/YouTube): Pink texts are hyperlinks to the respective website that you can simply click on

---
# Setting up API Access
  
- First of all, we need a Google account.
- You can use an already existing one or create a new one
- For safety reasons, we advise you to create a new account
  (If you accidentally share your login credentials, people using the credentials only
  have access to your Bot account and not your personal or work account)
- You can create a new account [here](https://accounts.google.com/signup/v2/webcreateaccount?service=mail&amp;continue=https%3A%2F%2Fmail.google.com%2Fmail%2F&amp;ltmpl=googlemail&amp;gmb=exp&amp;biz=false&amp;flowName=GlifWebSignIn&amp;flowEntry=SignUp)

- Second, we need to:
  - Sign up for the Google developer console
  - Create a new Project
  - Activate the YouTube Data API
  - Create Authentification Credentials
  - Test the credentials

---
# Google Developer Console
  
- Go to the [Developer Console](https://console.developers.google.com) and log in with your new Google Account

![plot](PrepImag/1.png)
![plot](PrepImag/2.png)

---
# Google Developer Console

- Create a new Project by clicking on the "Create" button on the top right Corner

![plot](PrepImag/3.png)

---
# Watch out!
  
- You only have a limited number of Projects that you can create, so be carefull not
to constantly delete and create new ones!

- More information on project limitations can be found [here](https://support.google.com/cloud/answer/6330231)

---
# Creating a New Project
  
- Specify a project name (you do not have to indicate an organisation) and click on "create" once you are done

![plot](PrepImag/4.png)

---
# Activate the YouTube Data v3 API
  
- Click on the button to "Enable APIs and Services" on the top of your screen

![plot](PrepImag/5.png)

---
# Activate the YouTube Data v3 API
  
- Enter "Youtube" in the search bar

![plot](PrepImag/6.png)

---
# Activate the YouTube Data v3 API

- Click on "YouTube Data API v3" 

![plot](PrepImag/7.png)

---
# Activate the YouTube Data v3 API

- Activate the API by clicking on the "Enable" button

![plot](PrepImag/9.png)
---
class: center, middle

# The API is now enabled! But we still need credentials to use it.

---
# Obtaining OAuth Credentials

- Click on the "Credentials" pane in the menu on the left side

![plot](PrepImag/10.png)

---
# Obtaining OAuth Credentials

- Click on the "+ Create Credentials" button on the top of your screen and select "OAuth Client ID" from the drop
  down menu

![plot](PrepImag/12.png)

---
# Obtaining OAuth Credentials

- To be able to create new credentials, we first need to configure a consent screen for our "App"

- Click on the blue button saying "Configure Consent Screen" on the right side of your screen

![plot](PrepImag/13.png)

---
# Configuring Consent Screen

- Fill the field "application name" with a name for your "App", scroll to the bottom of the page 
  and click "save"

![plot](PrepImag/14.png)


---
# Obtaining OAuth Credentials

- On the following screen, select the "Credentials" pane again from the menu on the left side of your screen

![plot](PrepImag/16.png)

---
# Obtaining OAuth Credentials

- We can now specify our credentials! Select the application type "other" and enter a name for your
  set of credentials. Afterwards, click on "create".

![plot](PrepImag/17.png)

---
# Success!

- We now have our first set of OAuth credentials for using the YouTube API!

- Don't worry about closing the window, we can access them again anytime

![plot](PrepImag/18.png)

---
# Words of Advice

- Have one account and project ready for the workshop that you know works but do not use too excessively in advance to
  not get it suspended before the workshop
  
- Never ever share your login credentials! This can easily happen by accident when
  - saving code in a GitHub Repo
  - sending scripts to colleages
  - Troubleshooting someone elses code
  - For added security, you can use the [Keyring package](https://cran.r-project.org/web/packages/keyring/keyring.pdf) (more info in workshop)
  
---
class: center, middle

# The API is now ready to use, but we still need to test if everything is working

---
# Testing Access

- You can try whether your account works as intendend without using it too excessively by running the 
  following commands in R. This should open a browser window:


```r
# installing the tuber package
install.packages("tuber")

# loading tuber package
library(tuber)

# Your Credentials (NEVER SHARE THIS INFORMATION)
ID &lt;- "ENTER-YOUR-APP-ID"
secret &lt;- "ENTER-YOUR-APP-SECRET"

# authentication
yt_oauth(ID,secret)

# You will be asked in the R-console to
# save an access token: Select no

# You will be send to your browser to
# login with your account
```
---
# Login 

- Select the Google Account that you used to set up the credentials

![plot](PrepImag/20.png)
---
# Access "unsecure App"

- We did not verify our "App", this is why Google labels it as "unsecure". Because we're the only ones using it,
  this doesn't bother us. Click on "Advanced" on the bottom left

![plot](PrepImag/21.png)
---
# Access "unsecure App"

- Click on "Go to [Name of your App] (unsafe)" on the bottom left of your screen

![plot](PrepImag/22.png)

---
# Access "unsecure App"

- Click on "Allow"

![plot](PrepImag/23.png)

---
# Access "unsecure App"

- Click on "Allow" again to confirm your choice

![plot](PrepImag/24.png)
---
# Access "unsecure App"

- You should now see the message "Authentication complete. Please close this page and return to R"

![plot](PrepImag/25.png)

---
# Test API call

- To check if everything worked, lets try to get some info about a video


```r
# get statistics of 1 video
get_stats(video_id="HluANRwPyNo")
```

---
# Output

- If everything worked correctly, your output should look something like this:


```r
$id
[1] "HluANRwPyNo"

$viewCount
[1] "10244939"

$likeCount
[1] "509791"

$dislikeCount
[1] "4799"

$favoriteCount
[1] "0"

$commentCount
[1] "20581"
```
---
class: center, middle

# We are looking forward to seeing you in Cologne!

---
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/remark/0.14.0/remark.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
